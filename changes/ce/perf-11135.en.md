Improve time offset parser in rules engine and return uniform error codes.
